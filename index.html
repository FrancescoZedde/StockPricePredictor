<!DOCTYPE html>
<html>
    <head>
        <title>Demo</title>

        <script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>

        <!--<script src="node_modules/technicalindicators/dist/browser.es6.js"></script>-->


        <!-- Import TensorFlow.js -->
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0/dist/tf.min.js"></script>
        <!-- Import tfjs-vis -->
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.0.2/dist/tfjs-vis.umd.min.js"></script>

        <script src="/socket.io/socket.io.js"></script>

        <!-- Import the main script file -->
        <!--<script src="script.js"></script>-->



    </head>

    <body>

        <h1>Look at the console</h1>
        <h2>(F12 o Dev Tools)</h2>

        <button id="predict-button">CLICCA</button>
        <br>
        <textarea id="finalResult"></textarea>

        <script>
            var socket = io();

            const predictButton = document.getElementById('predict-button');

            predictButton.onclick = () => {
                predictButton.disabled = true;
                socket.emit('predict');
            };

            socket.on('training', (result) => {
                grafico(result, "Training");
            });

            socket.on('testing', (result) => {
                grafico(result, "Testing");
            });

            socket.on('final', (result) => {
                let result2=JSON.parse(result);
                $("#finalResult").html("Crescita: " + result2[0] + " Giusti: " + result2[1] + " Errori: " + result2[2] + " Pari: " + result2[3]);
            });

            function grafico(bi_array_json, titolo)
            {
                let result = JSON.parse(bi_array_json);

                tfvis.render.linechart(
                        {name: titolo},
                        {values: [result[0], result[1]], series: ['original', 'predicted']},
                        {
                            xLabel: 'contatore',
                            yLabel: 'prezzo',
                            height: 300,
                            zoomToFit: true
                        }
                );
            }
        </script>

    </body>
</html>